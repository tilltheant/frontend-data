(function () {
  'use strict';

  //ophalen data van alle autos met hun kleur
  const kentekenautos =
    'https://opendata.rdw.nl/resource/m9d7-ebf2.json?$limit=10000';

  //wachten op de data en dan de data omzetten naar visualisatie

  getData().then((resultaat) => {
    const jaardata = count(resultaat);
    const sortedData = jaardata.sort(sortByYear);
    datavismaken(sortedData);
  });

  //de visualisatie!!! bron: https://www.d3-graph-gallery.com/graph/barplot_button_data_hard.html
  //---------------------------------------------------------------------------------------------------
  function datavismaken(sortedData) {
    // vast margin voor hergebruik
    const margin = { top: 30, right: 30, bottom: 70, left: 60 },
      width = 560 - margin.left - margin.right,
      height = 400 - margin.top - margin.bottom;

    // koppelen van de html svg en aanmaken van de attri aan de svg
    let svg = d3
      .select('#my_dataviz')
      .append('svg')
      .attr('width', width + margin.left + margin.right)
      .attr('height', height + margin.top + margin.bottom)
      .append('g')
      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');

    // Maken X As
    let xScale = d3.scaleBand().range([0, width]).padding(0.2);
    let xAxis = svg.append('g').attr('transform', 'translate(0,' + height + ')');

    // maken Y As
    let yScale = d3.scaleLinear().range([height, 0]);
    let yAxis = svg.append('g').attr('class', 'myYaxis');

    //text toevoegen aan de SVG
    svg
      .append('text')
      .attr('x', width / 2)
      .attr('y', 0 - margin.top / 10)
      .attr('text-anchor', 'middle')
      .style('font-size', '20px')
      .style('text-decoration', 'none')
      .text("Meest verkochte auto's per kleur in Nederland");


    // functie maken die de data update op basis van de gegeven data
    //---------------------------------------------------------------------------------------------------
    function update(dataJaareen) {
      console.log(dataJaareen);
      let data = dataJaareen.data;

      // Update the X axis
      xScale.domain(
        data.map(function (d) {
          return d.color;
        })
      );
      xAxis.call(d3.axisBottom(xScale));

      // Update the Y axis
      yScale.domain([
        0,
        d3.max(data, function (d) {
          return d.value;
        }),
      ]);
      yAxis.transition().duration(1000).call(d3.axisLeft(yScale));

      // maak nieuwe let
      let change = svg.selectAll('rect').data(data);
  //met merge() combineer je de UPDATE en ENTER samen zodat het een geheel is
      change
        .enter()
        .append('rect') // Add a new rect for each new elements
        .merge(change) // get the already existing elements as well
        .transition() // and apply changes to all of them
        .duration(1000)
        .attr('x', function (d) {
          return xScale(d.color);
        })
        .attr('y', function (d) {
          return yScale(d.value);
        })
        .attr('width', xScale.bandwidth())
        .attr('height', function (d) {
          return height - yScale(d.value);
        })
        .attr('fill', '#69b3a2');

      // If less group in the new dataset, I delete the ones not in use anymore
      change.exit().remove();
    }

    // Initialize the plot with the first dataset
    update(sortedData[72]);

    d3.selectAll("input[name='years']").on('change', function () {
      if (this.value == 2016) {
        update(sortedData[60]);
      } else {
        update(sortedData[72]);
      }
    });
  }











  //FUNCTIES
  //---------------------------------------------------------------------------------------------------

  //ophalen van de data, met async wachten totdat de data binnenisgehaald in een json
  //vervolgens filteren naar een andere array door eroverheen te mappen
  //dan de gefilterede data weer filteren op datum(alleen het jaartal de eerste 4 letters) en kleur
  async function getData() {
    const data = await dataophalen(kentekenautos);
    const filtered = filterenhelearray(data);
    const combinedData = filtered.map((item) => {
      return {
        year: item.datum_eerste_toelating.substring(0, 4),
        color: item.eerste_kleur,
      };
    });
    return combinedData;
  }

  // de data ophalen en wachten op een antwoord voordat die verder gaat, vervolgens de data omzetten naar een json
  async function dataophalen(url) {
    const antwoord = await fetch(url);
    const data = await antwoord.json(url);
    return data;
  }

  //zoeken naar het year in de object van RDW als die true is dan return hij die waarde
  function findYearIndex(yearItem, array) {
    return array.findIndex((item) => yearItem.year === item.year);
  }

  // samen met gijs gemaakt tellen van de jaartallen en kleuren per jaartal
  function count(array) {
    // Create a new array called yearlyData
    const yearlyData = [];

    // Loop through all our items in our json fetch, they all have their own individual year & color value
    // We need to assign them to the right year by finding their index's
    array.forEach((item) => {

      // Find index of this year, if it's -1 make a new object.
      const yearIndex = findYearIndex(item, yearlyData);

      // If the year is not indexed yet, create a new object inside the year array.
      if (yearIndex < 0) {
        yearlyData.push({
          year: item.year,
          data: [
            {
              color: item.color,
              value: 1,
            },
          ],
        });
      } else {
        // Add this item's data to the corrosponding year
        // Get the index of the color data
        // Check if the color exists, if yes add up one to the value or otherwise create new object with value 1
        const colorData = yearlyData[yearIndex].data;
        const colorIndexInYear = colorData.findIndex(
          (color) => color.color === item.color
        );

        if (colorIndexInYear < 0) {
          colorData.push({
            color: item.color,
            value: 1,
          });
        } else {
          colorData[colorIndexInYear].value++;
        }
      }
    });

    return yearlyData;
  }

  //hele dataset filteren en in een array zetten
  function filterenhelearray(data) {
    return data.map((uitkomst) => uitkomst);
  }

  //sorteren op jaar, door de strings naar numbers te veranderen || samen met gijs gemaakt.
  function sortByYear(a, b) {
    const yearA = Number(a.year);
    const yearB = Number(b.year);

    if (yearA < yearB) return -1;
    if (yearA > yearB) return 1;
    return 0;
  }

}());

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vb3BoYWxlbiBkYXRhIHZhbiBhbGxlIGF1dG9zIG1ldCBodW4ga2xldXJcbmNvbnN0IGtlbnRla2VuYXV0b3MgPVxuICAnaHR0cHM6Ly9vcGVuZGF0YS5yZHcubmwvcmVzb3VyY2UvbTlkNy1lYmYyLmpzb24/JGxpbWl0PTEwMDAwJztcblxuLy93YWNodGVuIG9wIGRlIGRhdGEgZW4gZGFuIGRlIGRhdGEgb216ZXR0ZW4gbmFhciB2aXN1YWxpc2F0aWVcblxuZ2V0RGF0YSgpLnRoZW4oKHJlc3VsdGFhdCkgPT4ge1xuICBjb25zdCBqYWFyZGF0YSA9IGNvdW50KHJlc3VsdGFhdCk7XG4gIGNvbnN0IHNvcnRlZERhdGEgPSBqYWFyZGF0YS5zb3J0KHNvcnRCeVllYXIpO1xuICBkYXRhdmlzbWFrZW4oc29ydGVkRGF0YSk7XG59KTtcblxuLy9kZSB2aXN1YWxpc2F0aWUhISEgYnJvbjogaHR0cHM6Ly93d3cuZDMtZ3JhcGgtZ2FsbGVyeS5jb20vZ3JhcGgvYmFycGxvdF9idXR0b25fZGF0YV9oYXJkLmh0bWxcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBkYXRhdmlzbWFrZW4oc29ydGVkRGF0YSkge1xuICAvLyB2YXN0IG1hcmdpbiB2b29yIGhlcmdlYnJ1aWtcbiAgY29uc3QgbWFyZ2luID0geyB0b3A6IDMwLCByaWdodDogMzAsIGJvdHRvbTogNzAsIGxlZnQ6IDYwIH0sXG4gICAgd2lkdGggPSA1NjAgLSBtYXJnaW4ubGVmdCAtIG1hcmdpbi5yaWdodCxcbiAgICBoZWlnaHQgPSA0MDAgLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbTtcblxuICAvLyBrb3BwZWxlbiB2YW4gZGUgaHRtbCBzdmcgZW4gYWFubWFrZW4gdmFuIGRlIGF0dHJpIGFhbiBkZSBzdmdcbiAgbGV0IHN2ZyA9IGQzXG4gICAgLnNlbGVjdCgnI215X2RhdGF2aXonKVxuICAgIC5hcHBlbmQoJ3N2ZycpXG4gICAgLmF0dHIoJ3dpZHRoJywgd2lkdGggKyBtYXJnaW4ubGVmdCArIG1hcmdpbi5yaWdodClcbiAgICAuYXR0cignaGVpZ2h0JywgaGVpZ2h0ICsgbWFyZ2luLnRvcCArIG1hcmdpbi5ib3R0b20pXG4gICAgLmFwcGVuZCgnZycpXG4gICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIG1hcmdpbi5sZWZ0ICsgJywnICsgbWFyZ2luLnRvcCArICcpJyk7XG5cbiAgLy8gTWFrZW4gWCBBc1xuICBsZXQgeFNjYWxlID0gZDMuc2NhbGVCYW5kKCkucmFuZ2UoWzAsIHdpZHRoXSkucGFkZGluZygwLjIpO1xuICBsZXQgeEF4aXMgPSBzdmcuYXBwZW5kKCdnJykuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgwLCcgKyBoZWlnaHQgKyAnKScpO1xuXG4gIC8vIG1ha2VuIFkgQXNcbiAgbGV0IHlTY2FsZSA9IGQzLnNjYWxlTGluZWFyKCkucmFuZ2UoW2hlaWdodCwgMF0pO1xuICBsZXQgeUF4aXMgPSBzdmcuYXBwZW5kKCdnJykuYXR0cignY2xhc3MnLCAnbXlZYXhpcycpO1xuXG4gIC8vdGV4dCB0b2V2b2VnZW4gYWFuIGRlIFNWR1xuICBzdmdcbiAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAuYXR0cigneCcsIHdpZHRoIC8gMilcbiAgICAuYXR0cigneScsIDAgLSBtYXJnaW4udG9wIC8gMTApXG4gICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgLnN0eWxlKCdmb250LXNpemUnLCAnMjBweCcpXG4gICAgLnN0eWxlKCd0ZXh0LWRlY29yYXRpb24nLCAnbm9uZScpXG4gICAgLnRleHQoXCJNZWVzdCB2ZXJrb2NodGUgYXV0bydzIHBlciBrbGV1ciBpbiBOZWRlcmxhbmRcIik7XG5cblxuICAvLyBmdW5jdGllIG1ha2VuIGRpZSBkZSBkYXRhIHVwZGF0ZSBvcCBiYXNpcyB2YW4gZGUgZ2VnZXZlbiBkYXRhXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGZ1bmN0aW9uIHVwZGF0ZShkYXRhSmFhcmVlbikge1xuICAgIGNvbnNvbGUubG9nKGRhdGFKYWFyZWVuKTtcbiAgICBsZXQgZGF0YSA9IGRhdGFKYWFyZWVuLmRhdGE7XG5cbiAgICAvLyBVcGRhdGUgdGhlIFggYXhpc1xuICAgIHhTY2FsZS5kb21haW4oXG4gICAgICBkYXRhLm1hcChmdW5jdGlvbiAoZCkge1xuICAgICAgICByZXR1cm4gZC5jb2xvcjtcbiAgICAgIH0pXG4gICAgKTtcbiAgICB4QXhpcy5jYWxsKGQzLmF4aXNCb3R0b20oeFNjYWxlKSk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIFkgYXhpc1xuICAgIHlTY2FsZS5kb21haW4oW1xuICAgICAgMCxcbiAgICAgIGQzLm1heChkYXRhLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICByZXR1cm4gZC52YWx1ZTtcbiAgICAgIH0pLFxuICAgIF0pO1xuICAgIHlBeGlzLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKS5jYWxsKGQzLmF4aXNMZWZ0KHlTY2FsZSkpO1xuXG4gICAgLy8gbWFhayBuaWV1d2UgbGV0XG4gICAgbGV0IGNoYW5nZSA9IHN2Zy5zZWxlY3RBbGwoJ3JlY3QnKS5kYXRhKGRhdGEpO1xuLy9tZXQgbWVyZ2UoKSBjb21iaW5lZXIgamUgZGUgVVBEQVRFIGVuIEVOVEVSIHNhbWVuIHpvZGF0IGhldCBlZW4gZ2VoZWVsIGlzXG4gICAgY2hhbmdlXG4gICAgICAuZW50ZXIoKVxuICAgICAgLmFwcGVuZCgncmVjdCcpIC8vIEFkZCBhIG5ldyByZWN0IGZvciBlYWNoIG5ldyBlbGVtZW50c1xuICAgICAgLm1lcmdlKGNoYW5nZSkgLy8gZ2V0IHRoZSBhbHJlYWR5IGV4aXN0aW5nIGVsZW1lbnRzIGFzIHdlbGxcbiAgICAgIC50cmFuc2l0aW9uKCkgLy8gYW5kIGFwcGx5IGNoYW5nZXMgdG8gYWxsIG9mIHRoZW1cbiAgICAgIC5kdXJhdGlvbigxMDAwKVxuICAgICAgLmF0dHIoJ3gnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICByZXR1cm4geFNjYWxlKGQuY29sb3IpO1xuICAgICAgfSlcbiAgICAgIC5hdHRyKCd5JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIHlTY2FsZShkLnZhbHVlKTtcbiAgICAgIH0pXG4gICAgICAuYXR0cignd2lkdGgnLCB4U2NhbGUuYmFuZHdpZHRoKCkpXG4gICAgICAuYXR0cignaGVpZ2h0JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIGhlaWdodCAtIHlTY2FsZShkLnZhbHVlKTtcbiAgICAgIH0pXG4gICAgICAuYXR0cignZmlsbCcsICcjNjliM2EyJyk7XG5cbiAgICAvLyBJZiBsZXNzIGdyb3VwIGluIHRoZSBuZXcgZGF0YXNldCwgSSBkZWxldGUgdGhlIG9uZXMgbm90IGluIHVzZSBhbnltb3JlXG4gICAgY2hhbmdlLmV4aXQoKS5yZW1vdmUoKTtcbiAgfVxuXG4gIC8vIEluaXRpYWxpemUgdGhlIHBsb3Qgd2l0aCB0aGUgZmlyc3QgZGF0YXNldFxuICB1cGRhdGUoc29ydGVkRGF0YVs3Ml0pO1xuXG4gIGQzLnNlbGVjdEFsbChcImlucHV0W25hbWU9J3llYXJzJ11cIikub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy52YWx1ZSA9PSAyMDE2KSB7XG4gICAgICB1cGRhdGUoc29ydGVkRGF0YVs2MF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB1cGRhdGUoc29ydGVkRGF0YVs3Ml0pO1xuICAgIH1cbiAgfSk7XG59XG5cblxuXG5cblxuXG5cblxuXG5cblxuLy9GVU5DVElFU1xuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy9vcGhhbGVuIHZhbiBkZSBkYXRhLCBtZXQgYXN5bmMgd2FjaHRlbiB0b3RkYXQgZGUgZGF0YSBiaW5uZW5pc2dlaGFhbGQgaW4gZWVuIGpzb25cbi8vdmVydm9sZ2VucyBmaWx0ZXJlbiBuYWFyIGVlbiBhbmRlcmUgYXJyYXkgZG9vciBlcm92ZXJoZWVuIHRlIG1hcHBlblxuLy9kYW4gZGUgZ2VmaWx0ZXJlZGUgZGF0YSB3ZWVyIGZpbHRlcmVuIG9wIGRhdHVtKGFsbGVlbiBoZXQgamFhcnRhbCBkZSBlZXJzdGUgNCBsZXR0ZXJzKSBlbiBrbGV1clxuYXN5bmMgZnVuY3Rpb24gZ2V0RGF0YSgpIHtcbiAgY29uc3QgZGF0YSA9IGF3YWl0IGRhdGFvcGhhbGVuKGtlbnRla2VuYXV0b3MpO1xuICBjb25zdCBmaWx0ZXJlZCA9IGZpbHRlcmVuaGVsZWFycmF5KGRhdGEpO1xuICBjb25zdCBjb21iaW5lZERhdGEgPSBmaWx0ZXJlZC5tYXAoKGl0ZW0pID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgeWVhcjogaXRlbS5kYXR1bV9lZXJzdGVfdG9lbGF0aW5nLnN1YnN0cmluZygwLCA0KSxcbiAgICAgIGNvbG9yOiBpdGVtLmVlcnN0ZV9rbGV1cixcbiAgICB9O1xuICB9KTtcbiAgcmV0dXJuIGNvbWJpbmVkRGF0YTtcbn1cblxuLy8gZGUgZGF0YSBvcGhhbGVuIGVuIHdhY2h0ZW4gb3AgZWVuIGFudHdvb3JkIHZvb3JkYXQgZGllIHZlcmRlciBnYWF0LCB2ZXJ2b2xnZW5zIGRlIGRhdGEgb216ZXR0ZW4gbmFhciBlZW4ganNvblxuYXN5bmMgZnVuY3Rpb24gZGF0YW9waGFsZW4odXJsKSB7XG4gIGNvbnN0IGFudHdvb3JkID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgY29uc3QgZGF0YSA9IGF3YWl0IGFudHdvb3JkLmpzb24odXJsKTtcbiAgcmV0dXJuIGRhdGE7XG59XG5cbi8vem9la2VuIG5hYXIgaGV0IHllYXIgaW4gZGUgb2JqZWN0IHZhbiBSRFcgYWxzIGRpZSB0cnVlIGlzIGRhbiByZXR1cm4gaGlqIGRpZSB3YWFyZGVcbmZ1bmN0aW9uIGZpbmRZZWFySW5kZXgoeWVhckl0ZW0sIGFycmF5KSB7XG4gIHJldHVybiBhcnJheS5maW5kSW5kZXgoKGl0ZW0pID0+IHllYXJJdGVtLnllYXIgPT09IGl0ZW0ueWVhcik7XG59XG5cbi8vIHNhbWVuIG1ldCBnaWpzIGdlbWFha3QgdGVsbGVuIHZhbiBkZSBqYWFydGFsbGVuIGVuIGtsZXVyZW4gcGVyIGphYXJ0YWxcbmZ1bmN0aW9uIGNvdW50KGFycmF5KSB7XG4gIC8vIENyZWF0ZSBhIG5ldyBhcnJheSBjYWxsZWQgeWVhcmx5RGF0YVxuICBjb25zdCB5ZWFybHlEYXRhID0gW107XG5cbiAgLy8gTG9vcCB0aHJvdWdoIGFsbCBvdXIgaXRlbXMgaW4gb3VyIGpzb24gZmV0Y2gsIHRoZXkgYWxsIGhhdmUgdGhlaXIgb3duIGluZGl2aWR1YWwgeWVhciAmIGNvbG9yIHZhbHVlXG4gIC8vIFdlIG5lZWQgdG8gYXNzaWduIHRoZW0gdG8gdGhlIHJpZ2h0IHllYXIgYnkgZmluZGluZyB0aGVpciBpbmRleCdzXG4gIGFycmF5LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAvL2Rlc3RydWN0dXJpbmcgY29uc3Qgdm9vciBvdmVyemljaHRsaWpraGVpZC5cbiAgICBjb25zdCB7IGNvbG9yLCB5ZWFyIH0gPSBpdGVtO1xuXG4gICAgLy8gRmluZCBpbmRleCBvZiB0aGlzIHllYXIsIGlmIGl0J3MgLTEgbWFrZSBhIG5ldyBvYmplY3QuXG4gICAgY29uc3QgeWVhckluZGV4ID0gZmluZFllYXJJbmRleChpdGVtLCB5ZWFybHlEYXRhKTtcblxuICAgIC8vIElmIHRoZSB5ZWFyIGlzIG5vdCBpbmRleGVkIHlldCwgY3JlYXRlIGEgbmV3IG9iamVjdCBpbnNpZGUgdGhlIHllYXIgYXJyYXkuXG4gICAgaWYgKHllYXJJbmRleCA8IDApIHtcbiAgICAgIHllYXJseURhdGEucHVzaCh7XG4gICAgICAgIHllYXI6IGl0ZW0ueWVhcixcbiAgICAgICAgZGF0YTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvbG9yOiBpdGVtLmNvbG9yLFxuICAgICAgICAgICAgdmFsdWU6IDEsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBZGQgdGhpcyBpdGVtJ3MgZGF0YSB0byB0aGUgY29ycm9zcG9uZGluZyB5ZWFyXG4gICAgICAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBjb2xvciBkYXRhXG4gICAgICAvLyBDaGVjayBpZiB0aGUgY29sb3IgZXhpc3RzLCBpZiB5ZXMgYWRkIHVwIG9uZSB0byB0aGUgdmFsdWUgb3Igb3RoZXJ3aXNlIGNyZWF0ZSBuZXcgb2JqZWN0IHdpdGggdmFsdWUgMVxuICAgICAgY29uc3QgY29sb3JEYXRhID0geWVhcmx5RGF0YVt5ZWFySW5kZXhdLmRhdGE7XG4gICAgICBjb25zdCBjb2xvckluZGV4SW5ZZWFyID0gY29sb3JEYXRhLmZpbmRJbmRleChcbiAgICAgICAgKGNvbG9yKSA9PiBjb2xvci5jb2xvciA9PT0gaXRlbS5jb2xvclxuICAgICAgKTtcblxuICAgICAgaWYgKGNvbG9ySW5kZXhJblllYXIgPCAwKSB7XG4gICAgICAgIGNvbG9yRGF0YS5wdXNoKHtcbiAgICAgICAgICBjb2xvcjogaXRlbS5jb2xvcixcbiAgICAgICAgICB2YWx1ZTogMSxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb2xvckRhdGFbY29sb3JJbmRleEluWWVhcl0udmFsdWUrKztcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB5ZWFybHlEYXRhO1xufVxuXG4vL2hlbGUgZGF0YXNldCBmaWx0ZXJlbiBlbiBpbiBlZW4gYXJyYXkgemV0dGVuXG5mdW5jdGlvbiBmaWx0ZXJlbmhlbGVhcnJheShkYXRhKSB7XG4gIHJldHVybiBkYXRhLm1hcCgodWl0a29tc3QpID0+IHVpdGtvbXN0KTtcbn1cblxuLy9zb3J0ZXJlbiBvcCBqYWFyLCBkb29yIGRlIHN0cmluZ3MgbmFhciBudW1iZXJzIHRlIHZlcmFuZGVyZW4gfHwgc2FtZW4gbWV0IGdpanMgZ2VtYWFrdC5cbmZ1bmN0aW9uIHNvcnRCeVllYXIoYSwgYikge1xuICBjb25zdCB5ZWFyQSA9IE51bWJlcihhLnllYXIpO1xuICBjb25zdCB5ZWFyQiA9IE51bWJlcihiLnllYXIpO1xuXG4gIGlmICh5ZWFyQSA8IHllYXJCKSByZXR1cm4gLTE7XG4gIGlmICh5ZWFyQSA+IHllYXJCKSByZXR1cm4gMTtcbiAgcmV0dXJuIDA7XG59Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztFQUFBO0VBQ0EsTUFBTSxhQUFhO0VBQ25CLEVBQUUsOERBQThELENBQUM7QUFDakU7RUFDQTtBQUNBO0VBQ0EsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUyxLQUFLO0VBQzlCLEVBQUUsTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0VBQ3BDLEVBQUUsTUFBTSxVQUFVLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztFQUMvQyxFQUFFLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQztFQUMzQixDQUFDLENBQUMsQ0FBQztBQUNIO0VBQ0E7RUFDQTtFQUNBLFNBQVMsWUFBWSxDQUFDLFVBQVUsRUFBRTtFQUNsQztFQUNBLEVBQUUsTUFBTSxNQUFNLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFO0VBQzdELElBQUksS0FBSyxHQUFHLEdBQUcsR0FBRyxNQUFNLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQyxLQUFLO0VBQzVDLElBQUksTUFBTSxHQUFHLEdBQUcsR0FBRyxNQUFNLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFD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